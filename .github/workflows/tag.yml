name: Semver Bump

on:
  push:
    branches:
      - master

jobs:
  tag:
    name: bump semver
    runs-on: ubuntu latest
    steps:
      name: bump semver
      run: |
        # if we have a blank tag, get all commits
        if [ -z "$t" ]
        then
            log=$(git log --pretty=oneline)
            t=0.0.0
        # otherwise, get commits since last tag
        else
            log=$(git log $t..HEAD --pretty=oneline)
        fi

        # supports #major, #minor, #patch (anything else will be 'minor')
        case "$log" in
            *#major* ) new=$(semver bump major $t);;
            *#patch* ) new=$(semver bump patch $t);;
            * ) new=$(semver bump minor $t);;
        esac
